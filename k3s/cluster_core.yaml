## AHL
---

- import_playbook: cert_manager.yaml

- name: Wait for cert-manager certificates to be ready.
  hosts: k3s_nodes_master[0]
  become: no
  gather_facts: no
  tasks:
    - ansible.builtin.shell: kubectl -n default wait --for=condition=Ready certificate {{ item }} --timeout=10s
      register: cert_ready
      until: cert_ready.rc == 0
      retries: 20
      delay: 10
      with_items: "{{ cert_manager_certs }}"

# - import_playbook: cloudflare.yaml

# - import_playbook: traefik.yaml

# - import_playbook: traefik_services.yaml

# - import_playbook: longhorn.yaml

## TODO - Wait for volumes to be ready (in Longhorn playbook)

# - import_playbook: pihole.yaml

# - import_playbook: twingate.yaml

# - import_playbook: uptime_kuma.yaml
