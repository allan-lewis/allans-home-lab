- name: Run guacd Docker container
  community.docker.docker_container:
    container_default_behavior: no_defaults
    detach: yes
    name: "guacd"
    image: "guacamole/guacd"
    state: "started"
    recreate: "yes"
    pull: "yes"
    restart_policy: "unless-stopped"
    published_ports: 
      - "{{ guacd_port }}:4822/tcp"

- name: Run Guacamole Docker container
  community.docker.docker_container:
    container_default_behavior: no_defaults
    detach: yes
    name: "guacamole"
    image: "guacamole/guacamole"
    state: "started"
    recreate: "yes"
    pull: "yes"
    restart_policy: "unless-stopped"
    published_ports: 
      - "{{ guacamole_port }}:8080/tcp"
    env: 
      GUACD_HOSTNAME: "{{ ansible_host }}"
      MYSQL_HOSTNAME: "{{ mysql_host }}"
      MYSQL_DATABASE: "{{ mysql_database }}"
      MYSQL_USER: "{{ mysql_user }}"
      MYSQL_PASSWORD: "{{ mysql_password }}"  
