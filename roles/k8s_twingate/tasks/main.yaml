## AHL
---
- ansible.builtin.include_role:
    name: k8s_generic_helm
  vars:
    homelab_k8s_twingate_access_token: "{{ twingate_item.access_token }}"
    homelab_k8s_twingate_refresh_token: "{{ twingate_item.refresh_token }}"
    homelab_k8s_helm_temp_dir: "{{ homelab_k8s_twingate_helm_temp_dir | default('/tmp') }}"
    homelab_k8s_helm_value_file: "{{ homelab_k8s_helm_temp_dir }}/{{ twingate_item.name }}-values.yaml"
    homelab_k8s_helm_value_files:
      - src: "homelab-k8s-helm-twingate.yaml.j2"
        dest: "{{ homelab_k8s_helm_value_file }}"
  loop: "{{ homelab_k8s_twingate_connectors | default([]) }}"  
  loop_control:
    loop_var: twingate_item
