---
- name: Setup WatchYourLAN
  hosts: wyl_nodes
  become: yes
  gather_facts: false

  roles:
    - role: util_directory
      vars:
        util_dirs:        
          - path: "{{ docker_volumes_directory }}/wyl"

  tasks:  
    - name: Setup WatchYourLAN
      community.docker.docker_container:
        container_default_behavior: no_defaults
        detach: yes
        name: "wyl"
        image: "aceberg/watchyourlan"
        state: "started"
        recreate: "yes"
        pull: "yes"
        restart_policy: "unless-stopped"
        network_mode: host
        volumes: 
          - "{{ docker_volumes_directory }}/wyl:/data"
        env: 
          IFACE: "{{ wyl_iface }}"
          GUIIP: "0.0.0.0"
          GUIPORT: "{{ wyl_port | int }}"
          TZ: America/New_York 